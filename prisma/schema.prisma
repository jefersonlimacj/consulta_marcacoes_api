generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Usuario {
  id       BigInt   @id @default(autoincrement())
  username String   @unique
  password String
  criadoEm DateTime @default(now()) @map("criado_em")

  @@map("usuario")
}

model Lider {
  id       BigInt     @id @default(autoincrement())
  nome     String
  telefone String
  exames   Marcacao[]

  @@map("lider")
}

model Paciente {
  id             BigInt     @id @default(autoincrement())
  nome           String
  cpf            String     @unique
  dataNascimento DateTime?
  telefone       String?
  nSus           String?    @map("n_sus")
  criadoEm       DateTime   @default(now())
  telefoneS      String?    @map("telefone_s")
  exames         Marcacao[]

  @@map("pacientes")
}

model Especialidade {
  id       BigInt     @id @default(autoincrement())
  nome     String     @unique
  criadoEm DateTime   @default(now()) @map("criado_em")
  exames   Marcacao[]

  @@map("especialidades")
}

model Medico {
  id     BigInt     @id @default(autoincrement())
  nome   String
  crm    String
  exames Marcacao[]

  @@map("medico")
}

model Marcacao {
  id              BigInt        @id @default(autoincrement())
  dataMarcada     DateTime?      @map("data_marcada")
  dataAtendimento DateTime?     @map("data_atendimento")
  status          ExameStatus   @default(MARCADO)
  observacoes     String?       @db.VarChar(255)
  pacienteId      BigInt        @map("paciente_id")
  especialidadeId BigInt        @map("especialidade_id")
  criadoEm        DateTime      @default(now()) @map("criado_em")
  liderId         BigInt?        @map("lider_id")
  tipoExame       String?        @map("tipo_exame")
  medicoId        BigInt?       @map("medico_id")
  retorno         Boolean       @default(false) @map("retorno")
  especialidade   Especialidade @relation(fields: [especialidadeId], references: [id])
  lider           Lider?         @relation(fields: [liderId], references: [id])
  medico          Medico?       @relation(fields: [medicoId], references: [id])
  paciente        Paciente      @relation(fields: [pacienteId], references: [id])

  @@map("marcacoes")
}

enum ExameStatus {
  AGUARDANDO
  MARCADO
  CANCELADO
}
